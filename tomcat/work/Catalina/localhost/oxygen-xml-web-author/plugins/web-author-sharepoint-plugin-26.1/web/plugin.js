(()=>{(function(){var N={SP_PREFS_:{en_US:"SharePoint preferences",de_DE:"SharePoint-Einstellungen",fr_FR:"Pr\xE9f\xE9rences SharePoint",ja_JP:"SharePoint \u306E\u74B0\u5883\u8A2D\u5B9A",nl_NL:"SharePoint-voorkeuren",zh_CN:"SharePoint\u9996\u9009\u9879"},APPLY_:{en_US:"Apply",de_DE:"Anwenden",fr_FR:"Appliquer",ja_JP:"\u9069\u7528",nl_NL:"Pas toe",zh_CN:"\u5E94\u7528"},CANCEL_:{en_US:"Cancel",de_DE:"Abbrechen",fr_FR:"Annuler",ja_JP:"\u30AD\u30E3\u30F3\u30BB\u30EB",nl_NL:"Annuleer",zh_CN:"\u53D6\u6D88"},CHOOSE_EDIT_START_:{en_US:"Choose what happens when you start editing",de_DE:"W\xE4hlen Sie, was nach dem Start der Bearbeitung passieren soll",fr_FR:"Choisissez ce qu'il se passe lorsque vous commencez l'\xE9dition",ja_JP:"\u7DE8\u96C6\u3092\u958B\u59CB\u3059\u308B\u3068\u304D\u3001\u4F55\u3092\u8D77\u52D5\u3059\u308B\u304B\u3092\u9078\u629E\u3059\u308B",nl_NL:"Kiezen wat er gebeurt wanneer u begint met bewerken",zh_CN:"\u9009\u62E9\u5F00\u59CB\u7F16\u8F91\u65F6\u53D1\u751F\u7684\u60C5\u51B5"},ALWAYS_ASK_:{en_US:"Always ask",de_DE:"Immer fragen",fr_FR:"Toujours demander",ja_JP:"\u5E38\u306B\u305F\u305A\u306D\u308B",nl_NL:"Vraag altijd",zh_CN:"\u59CB\u7EC8\u8BE2\u95EE"},SHAREPOINT_CHECK_OUT_:{en_US:"Check out",de_DE:"Check-Out",fr_FR:"Extraire",ja_JP:"\u30C1\u30A7\u30C3\u30AF\u30A2\u30A6\u30C8",nl_NL:"Uitchecken",zh_CN:"\u7B7E\u51FA"},DONT_CHECK_OUT_:{en_US:"Don't check out",de_DE:"Nicht auschecken",fr_FR:"Ne pas extraire",ja_JP:"\u30C1\u30A7\u30C3\u30AF\u30A2\u30A6\u30C8\u3057\u306A\u3044",nl_NL:"Niet uitchecken",zh_CN:"\u4E0D\u80FD\u7B7E\u51FA"},DONT_SHOW_AGAIN_:{en_US:"Don't show this message again",de_DE:"Nicht erneut anzeigen",fr_FR:"Ne plus afficher ce message",ja_JP:"\u518D\u5EA6\u3053\u308C\u3092\u8868\u793A\u3057\u306A\u3044",nl_NL:"Niet meer weergeven",zh_CN:"\u4E0D\u518D\u663E\u793A\u6B64\u6D88\u606F"},DOCUMENT_NOT_CHECKED_OUT_:{en_US:"The current document is not checked out.{$LINE_BREAK}Your work may be overridden by others if you continue without checking out.",de_DE:"Das aktuelle Dokument ist nicht ausgecheckt.{$LINE_BREAK}Ihre Arbeit k\xF6nnte von anderen \xFCberschrieben werden, wenn Sie ohne Checkout fortfahren.",fr_FR:"Le document actuel n'est pas extrait.{$LINE_BREAK}Votre travail pourrait \xEAtre \xE9cras\xE9 par d'autres si vous continuez sans extraire.",ja_JP:"\u73FE\u5728\u306E\u6587\u66F8\u306F\u3001\u30C1\u30A7\u30C3\u30AF\u30A2\u30A6\u30C8\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002{$LINE_BREAK}\u30C1\u30A7\u30C3\u30AF\u30A2\u30A6\u30C8\u3057\u306A\u3044\u3067\u7D9A\u884C\u3059\u308B\u5834\u5408\u3001\u4ED6\u30E6\u30FC\u30B6\u30FC\u306B\u3088\u308A\u5909\u66F4\u304C\u4E0A\u66F8\u304D\u3055\u308C\u308B\u53EF\u80FD\u6027\u304C\u3042\u308A\u307E\u3059\u3002",nl_NL:"Het huidige document is niet uitgecheckt.{$LINE_BREAK}Uw werk wordt mogelijk overschreven door anderen als u doorgaat zonder het document uit te checken.",zh_CN:"\u5F53\u524D\u6587\u6863\u672A\u7B7E\u51FA\u3002{$LINE_BREAK}\u5982\u679C\u7EE7\u7EED\u800C\u4E0D\u7B7E\u51FA\uFF0C\u5219\u5176\u4ED6\u4EBA\u53EF\u80FD\u4F1A\u8986\u76D6\u60A8\u7684\u5DE5\u4F5C\u3002"},CHECK_OUT_RECOMMENDED_:{en_US:"Check out recommended",de_DE:"Check-Out empfohlen",fr_FR:"Extraction recommand\xE9",ja_JP:"\u30C1\u30A7\u30C3\u30AF\u30A2\u30A6\u30C8\u3092\u63A8\u5968\u3057\u307E\u3059",nl_NL:"Uitchecken wordt aanbevolen",zh_CN:"\u5EFA\u8BAE\u7B7E\u51FA"},SP_DOCUMENT_CHECKED_OUT_BY_:{en_US:"Document is checked out by {$USERNAME}",de_DE:"Dokument ist ausgecheckt von {$USERNAME}",fr_FR:"Document extrait par {$USERNAME}",ja_JP:"\u30C9\u30AD\u30E5\u30E1\u30F3\u30C8\u306F\u3001{$USERNAME}\u306B\u3088\u308A\u30C1\u30A7\u30C3\u30AF\u30A2\u30A6\u30C8\u3055\u308C\u3066\u3044\u307E\u3059",nl_NL:"Document is uitgecheckt door {$USERNAME}",zh_CN:"\u6587\u6863\u7531{$USERNAME}\u7B7E\u51FA"},SP_DOCUMENT_CHECKED_OUT_:{en_US:"Document is checked out",de_DE:"Dokument ist ausgecheckt",fr_FR:"Document extrait",ja_JP:"\u30C9\u30AD\u30E5\u30E1\u30F3\u30C8\u306F\u3001\u30C1\u30A7\u30C3\u30AF\u30A2\u30A6\u30C8\u3055\u308C\u3066\u3044\u307E\u3059",nl_NL:"Document is uitgecheckt",zh_CN:"\u6587\u6863\u5DF2\u7B7E\u51FA"},SP_CHECK_OUT_FAILED_:{en_US:"Check out failed",de_DE:"Auschecken fehlgeschlagen",fr_FR:"\xC9chec de l'extraction",ja_JP:"\u30C1\u30A7\u30C3\u30AF\u30A2\u30A6\u30C8\u306B\u5931\u6557\u3057\u307E\u3057\u305F",nl_NL:"Uitchecken mislukt",zh_CN:"\u7B7E\u51FA\u5931\u8D25"},SP_CHECK_OUT_DESCRIPTION_:{en_US:"Check out this document from the library. A checked out document cannot be edited by anyone else while it is checked out.",de_DE:"Dieses Dokument aus der Bibliothek auschecken. Ein ausgechecktes Dokument kann von keiner anderen Person bearbeitet werden, solange es ausgecheckt ist.",fr_FR:"Extraire ce document depuis la biblioth\xE8que. Un document extrait ne peut pas \xEAtre \xE9dit\xE9 par quelqu'un d'autre pendant qu'il reste extrait.",ja_JP:"\u3053\u306E\u30C9\u30AD\u30E5\u30E1\u30F3\u30C8\u3092\u30E9\u30A4\u30D6\u30E9\u30EA\u304B\u3089\u30C1\u30A7\u30C3\u30AF\u30A2\u30A6\u30C8\u3057\u307E\u3059\u3002\u30C1\u30A7\u30C3\u30AF\u30A2\u30A6\u30C8\u3055\u308C\u305F\u30C9\u30AD\u30E5\u30E1\u30F3\u30C8\u306F\u3001\u30C1\u30A7\u30C3\u30AF\u30A2\u30A6\u30C8\u3055\u308C\u3066\u3044\u308B\u9593\u3001\u4ED6\u306E\u30E6\u30FC\u30B6\u30FC\u306F\u3001\u7DE8\u96C6\u3059\u308B\u3053\u3068\u304C\u3067\u304D\u307E\u305B\u3093\u3002",nl_NL:"Check dit document uit bij de bibliotheek. Een uitgecheckt document kan niet door anderen worden bewerkt zo lang het is uitgecheckt.",zh_CN:"\u4ECE\u5E93\u4E2D\u7B7E\u51FA\u6B64\u6587\u6863\u3002\u7B7E\u51FA\u7684\u6587\u6863\u5728\u7B7E\u51FA\u65F6\u4E0D\u80FD\u88AB\u5176\u4ED6\u4EBA\u7F16\u8F91\u3002"},SHAREPOINT_CHECK_IN_:{en_US:"Check in",de_DE:"Einchecken",fr_FR:"Archiver",ja_JP:"\u30C1\u30A7\u30C3\u30AF\u30A4\u30F3",nl_NL:"Inchecken",zh_CN:"\u7B7E\u5165"},SAVE_:{en_US:"Save",de_DE:"Speichern",fr_FR:"Enregistrer",ja_JP:"\u4FDD\u5B58",nl_NL:"Bewaar",zh_CN:"\u4FDD\u5B58"},SP_DIRTY_CHECK_IN_WARNING_:{en_US:"You have unsaved content in the document. The modified content will not be included in the checked in version.{$LINE_BREAK}{$LINE_BREAK}Do you want to save?",de_DE:"Im Dokument befindet sich nicht-gespeicherter Inhalt. Der bearbeitete Inhalt wird nicht in der einzucheckenden Version enthalten sein.{$LINE_BREAK}{$LINE_BREAK}M\xF6chten Sie speichern?",fr_FR:"Vous avez du contenu non enregistr\xE9 dans le document. Le contenu modifi\xE9 ne sera pas inclus dans la version archiv\xE9e.{$LINE_BREAK}{$LINE_BREAK}Voulez-vous sauvegarder?",ja_JP:"\u30C9\u30AD\u30E5\u30E1\u30F3\u30C8\u5185\u306B\u672A\u4FDD\u5B58\u306E\u30B3\u30F3\u30C6\u30F3\u30C4\u304C\u3042\u308A\u307E\u3059\u3002\u5909\u66F4\u3055\u308C\u305F\u30B3\u30F3\u30C6\u30F3\u30C4\u306F\u3001\u30C1\u30A7\u30C3\u30AF\u30A4\u30F3\u30D0\u30FC\u30B8\u30E7\u30F3\u306B\u306F\u542B\u307E\u308C\u3066\u3044\u307E\u305B\u3093\u3002{$LINE_BREAK}{$LINE_BREAK}\u4FDD\u5B58\u3057\u307E\u3059\u304B\uFF1F",nl_NL:"Het document bevat niet-opgeslagen content. De gewijzigde content wordt niet opgenomen in de ingecheckte versie.{$LINE_BREAK}{$LINE_BREAK}Wilt u de wijzigingen opslaan?",zh_CN:"\u6587\u6863\u4E2D\u6709\u672A\u4FDD\u5B58\u7684\u5185\u5BB9\u3002\u5DF2\u4FEE\u6539\u7684\u5185\u5BB9\u5C06\u4E0D\u5305\u542B\u5728\u7B7E\u5165\u7248\u672C\u4E2D\u3002{$LINE_BREAK}{$LINE_BREAK}\u662F\u5426\u4FDD\u5B58\uFF1F"},SP_CHECK_IN_WHICH_VERSION_:{en_US:"Which kind of version would you like to check in?",de_DE:"Welche Version m\xF6chten Sie einchecken?",fr_FR:"Quel genre de version voulez-vous archiver ?",ja_JP:"\u3069\u306E\u30D0\u30FC\u30B8\u30E7\u30F3\u3092\u30C1\u30A7\u30C3\u30AF\u30A4\u30F3\u3057\u307E\u3059\u304B\uFF1F",nl_NL:"Welk type versie wilt u inchecken?",zh_CN:"\u60A8\u60F3\u7B7E\u5165\u54EA\u79CD\u7248\u672C\uFF1F"},CHECK_IN_MINOR_VERSION_:{en_US:"Minor version",de_DE:"Unterversion",fr_FR:"Version mineure",ja_JP:"\u30DE\u30A4\u30CA\u30FC\u30D0\u30FC\u30B8\u30E7\u30F3",nl_NL:"Kleine versie",zh_CN:"\u6B21\u8981\u7248\u672C"},CHECK_IN_MAJOR_VERSION_:{en_US:"Major version",de_DE:"Hauptversion",fr_FR:"Version majeure",ja_JP:"\u30E1\u30B8\u30E3\u30FC\u30D0\u30FC\u30B8\u30E7\u30F3",nl_NL:"Grote versie",zh_CN:"\u4E3B\u8981\u7248\u672C"},SP_DESCRIBE_CHANGES_:{en_US:"Describe what has changed in this version:",de_DE:"Beschreiben Sie, was sich in dieser Version ge\xE4ndert hat:",fr_FR:"D\xE9crivez les changements de cette version :",ja_JP:"\u3053\u306E\u30D0\u30FC\u30B8\u30E7\u30F3\u3067\u306E\u5909\u66F4\u5185\u5BB9\u3092\u8AAC\u660E\u3059\u308B\uFF1A",nl_NL:"Beschrijf wat er is gewijzigd in deze versie:",zh_CN:"\u8BF7\u63CF\u8FF0\u6B64\u7248\u672C\u4E2D\u7684\u66F4\u6539\uFF1A"},SP_DOCUMENT_CHECKED_IN_:{en_US:"Document checked in",de_DE:"Dokument eingecheckt",fr_FR:"Document archiv\xE9",ja_JP:"\u30C9\u30AD\u30E5\u30E1\u30F3\u30C8\u304C\u3001\u30C1\u30A7\u30C3\u30AF\u30A4\u30F3\u3055\u308C\u307E\u3057\u305F",nl_NL:"Document ingecheckt",zh_CN:"\u6587\u6863\u7B7E\u5165"},SP_CHECK_IN_FAILED_:{en_US:"Check in failed",de_DE:"Einchecken fehlgeschlagen",fr_FR:"\xC9chec de l'archivage",ja_JP:"\u30C1\u30A7\u30C3\u30AF\u30A4\u30F3\u306B\u5931\u6557\u3057\u307E\u3057\u305F",nl_NL:"Inchecken mislukt",zh_CN:"\u7B7E\u5165\u5931\u8D25"},SAVE_AS_A_DIFFERENT_FILE_:{en_US:"Save as a different file",de_DE:"Als eine andere Datei speichern",fr_FR:"Enregistrer comme un autre fichier",ja_JP:"\u7570\u306A\u308B\u30D5\u30A1\u30A4\u30EB\u3068\u3057\u3066\u4FDD\u5B58\u3059\u308B",nl_NL:"Opslaan als een ander bestand",zh_CN:"\u53E6\u5B58\u4E3A\u5176\u4ED6\u6587\u4EF6"},FAILED_:{en_US:"failed",de_DE:"- fehlgeschlagen",fr_FR:"\xE9chec",ja_JP:"\u5931\u6557",nl_NL:"mislukt",zh_CN:"\u5931\u8D25"},SP_CHECK_IN_DOCUMENT_:{en_US:"Check in this document.",de_DE:"Dieses Dokument einchecken.",fr_FR:"Archiver ce document.",ja_JP:"\u3053\u306E\u30C9\u30AD\u30E5\u30E1\u30F3\u30C8\u3092\u30C1\u30A7\u30C3\u30AF\u30A4\u30F3\u3057\u307E\u3059\u3002",nl_NL:"Check dit document in.",zh_CN:"\u7B7E\u5165\u6B64\u6587\u6863\u3002"},DISCARD_CHECK_OUT_:{en_US:"Discard checkout",de_DE:"Check-Out verwerfen",fr_FR:"Annuler l'extraction",ja_JP:"\u30C1\u30A7\u30C3\u30AF\u30A2\u30A6\u30C8\u306E\u7834\u68C4",nl_NL:"Negeer uitchecken",zh_CN:"\u653E\u5F03\u7B7E\u51FA"},DISCARD_CHECK_OUT_WARNING_:{en_US:"If you discard the check out, you will lose all changes made to the document.{$LINE_BREAK}{$LINE_BREAK}Are you sure you want to discard the check out?",de_DE:"Wenn Sie den Checkout verwerfen, werden Sie alle im Dokument vorgenommenen \xC4nderungen verlieren.{$LINE_BREAK}{$LINE_BREAK}Sind Sie sicher, dass Sie den Checkout verwerfen m\xF6chten?",fr_FR:"Si vous annulez l'extraction, vous perdrez toutes les modifications faites sur le document.{$LINE_BREAK}{$LINE_BREAK}\xCAtes-vous s\xFBr de vouloir annuler l'extraction?",ja_JP:"\u30C1\u30A7\u30C3\u30AF\u30A2\u30A6\u30C8\u3092\u7834\u68C4\u3059\u308B\u3068\u3001\u30C9\u30AD\u30E5\u30E1\u30F3\u30C8\u306B\u5BFE\u3059\u308B\u3059\u3079\u3066\u306E\u5909\u66F4\u304C\u5931\u308F\u308C\u307E\u3059\u3002{$LINE_BREAK}{$LINE_BREAK}\u30C1\u30A7\u30C3\u30AF\u30A2\u30A6\u30C8\u3092\u7834\u68C4\u3057\u307E\u3059\u304B\uFF1F",nl_NL:"Als u het uitchecken negeert, gaan alle aangebrachte wijzigingen aan het document verloren.{$LINE_BREAK}{$LINE_BREAK}Weet u zeker dat u het uitchecken wilt negeren?",zh_CN:"\u5982\u679C\u653E\u5F03\u7B7E\u51FA\uFF0C\u5C06\u4E22\u5931\u5BF9\u6587\u6863\u6240\u505A\u7684\u6240\u6709\u66F4\u6539\u3002{$LINE_BREAK}{$LINE_BREAK}\u662F\u5426\u786E\u5B9E\u8981\u653E\u5F03\u7B7E\u51FA\uFF1F"},SP_CHECK_OUT_DISCARDED_:{en_US:"Document checkout discarded.",de_DE:"Checkout des Dokuments zur\xFCckgewiesen.",fr_FR:"Extraction du document annul\xE9e.",ja_JP:"\u30C1\u30A7\u30C3\u30AF\u30A2\u30A6\u30C8\u3055\u308C\u305F\u30C9\u30AD\u30E5\u30E1\u30F3\u30C8\u304C\u3001\u7834\u68C4\u3055\u308C\u307E\u3057\u305F\u3002",nl_NL:"Uitchecken van document negeren.",zh_CN:"\u5DF2\u653E\u5F03\u6587\u6863\u7B7E\u51FA\u3002"},SP_CHECK_IN_DISCARDING_CHANGES_:{en_US:"Check in this document, discarding any changes you have made.",de_DE:"Vorgenommene \xC4nderungen verwerfen und Dokument einchecken.",fr_FR:"Archiver ce document, annuler toutes les modifications que vous avez faites.",ja_JP:"\u3053\u306E\u30C9\u30AD\u30E5\u30E1\u30F3\u30C8\u3092\u30C1\u30A7\u30C3\u30AF\u30A4\u30F3\u3057\u3001\u884C\u3063\u305F\u3059\u3079\u3066\u306E\u5909\u66F4\u3092\u7834\u68C4\u3057\u307E\u3059\u3002",nl_NL:"Check dit document in, waarbij alle wijzigingen die u hebt aangebracht, worden verwijderd.",zh_CN:"\u7B7E\u5165\u6B64\u6587\u6863\uFF0C\u653E\u5F03\u6240\u505A\u7684\u4EFB\u4F55\u66F4\u6539\u3002"},SP_CONNECT_DIALOG_TITLE_:{en_US:"Office 365 Connect",fr_FR:"Connexion Office 365"},SP_CONNECT_INFO_:{en_US:"To access files stored on your SharePoint Online site you must connect to your Office 365 account.",fr_FR:"Pour acc\xE9der aux fichiers stock\xE9s sur votre site SharePoint Online vous devez vous connecter \xE0 votre compte Office 365."},SP_CONNECT_BUTTON_TOOLTIP_:{en_US:"Click to connect to your Office 365 account",fr_FR:"Cliquez pour vous connecter \xE0 votre compte Office 365"},SP_CONNECT_BUTTON_:{en_US:"Connect with Office 365",fr_FR:"Se connecter avec Office 365"},SP_PLUGIN_BAD_CONFIG_:{en_US:"The SharePoint plugin is not configured properly. If you are the administrator of the application make sure the Client ID and the Client Secret are properly set in the {$ANCHOR_START}Administration Page{$ANCHOR_END}.",de_DE:"Das SharePoint-Plugin ist nicht korrekt konfiguriert. Wenn Sie der Administrator der Anwendung sind, pr\xFCfen Sie, dass Client-ID und Client-Secret auf der {$ANCHOR_START}Administratorseite{$ANCHOR_END} korrekt sind.",fr_FR:"Le plugin SharePoint n'est pas correctement configur\xE9. Si vous \xEAtes l'administrateur de l'application assurez-vous que l'ID Client et que le Secret Client sont correctement d\xE9finis dans la {$ANCHOR_START}Page d'administration{$ANCHOR_END}.",ja_JP:"SharePoint\u30D7\u30E9\u30B0\u30A4\u30F3\u304C\u3001\u9069\u5207\u306B\u69CB\u6210\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002\u3042\u306A\u305F\u304C\u30A2\u30D7\u30EA\u30B1\u30FC\u30B7\u30E7\u30F3\u306E\u7BA1\u7406\u8005\u3067\u3042\u308B\u5834\u5408\u3001\u30AF\u30E9\u30A4\u30A2\u30F3\u30C8ID\u304A\u3088\u3073\u30AF\u30E9\u30A4\u30A2\u30F3\u30C8\u30B7\u30FC\u30AF\u30EC\u30C3\u30C8\u8A2D\u5B9A\u304C\u3001{$ANCHOR_START}\u7BA1\u7406\u30DA\u30FC\u30B8{$ANCHOR_END}\u3067\u9069\u5207\u306B\u8A2D\u5B9A\u3055\u308C\u3066\u3044\u308B\u3053\u3068\u3092\u78BA\u8A8D\u3057\u3066\u304F\u3060\u3055\u3044\u3002",nl_NL:"De SharePoint-plug-in is niet correct geconfigureerd. Als u de beheerder van het programma bent, controleert u of de client-ID en het clientgeheim correct zijn ingesteld op de {$ANCHOR_START}beheerpagina{$ANCHOR_END}.",zh_CN:"\u672A\u6B63\u786E\u914D\u7F6ESharePoint\u63D2\u4EF6\u3002\u5982\u679C\u60A8\u662F\u5E94\u7528\u7A0B\u5E8F\u7684\u7BA1\u7406\u5458\uFF0C\u8BF7\u786E\u4FDD\u5728{$ANCHOR_START}\u7BA1\u7406\u9875{$ANCHOR_END}\u4E2D\u6B63\u786E\u8BBE\u7F6E\u4E86\u5BA2\u6237\u7AEFID\u548C\u5BA2\u6237\u7AEF\u79D8\u94A5\u3002"},SERVER_URL_:{en_US:"Server URL",de_DE:"Server-URL",fr_FR:"URL du serveur",ja_JP:"\u30B5\u30FC\u30D0\u30FC URL",nl_NL:"Server-URL",zh_CN:"\u670D\u52A1\u5668URL"},EDIT_SERVER_URL_:{en_US:"Edit server URL",de_DE:"Server-URL bearbeiten",fr_FR:"\xC9diter l'URL du serveur",ja_JP:"\u30B5\u30FC\u30D0\u30FCURL\u3092\u7DE8\u96C6\u3059\u308B",nl_NL:"Server-URL bewerken",zh_CN:"\u7F16\u8F91\u670D\u52A1\u5668URL"},SP_SITE_TO_BROWSE_:{en_US:"Choose or enter the SharePoint site to browse",de_DE:"Zu durchsuchende SharePoint-Seite eingeben oder ausw\xE4hlen",fr_FR:"Choisir ou entrer un site SharePoint \xE0 naviguer",ja_JP:"SharePoint\u30B5\u30A4\u30C8\u3092\u9078\u629E\u3059\u308B\u3001\u3042\u308B\u3044\u306F\u5165\u3063\u3066\u53C2\u7167\u3059\u308B",nl_NL:"De SharePoint-site waarop u wilt zoeken, kiezen of invoeren",zh_CN:"\u9009\u62E9\u6216\u8F93\u5165\u8981\u6D4F\u89C8\u7684SharePoint\u7F51\u7AD9"},DISCONNECT_:{en_US:"Disconnect",fr_FR:"D\xE9connexion"},SP_OPEN_DESCRIPTION_:{en_US:"Open document from your SharePoint Online site",de_DE:"Dokument von Ihrer SharePoint-Online-Seite \xF6ffnen",fr_FR:"Ouvrir un document depuis votre site SharePoint Online",ja_JP:"SharePoint\u30AA\u30F3\u30E9\u30A4\u30F3\u30B5\u30A4\u30C8\u304B\u3089\u30C9\u30AD\u30E5\u30E1\u30F3\u30C8\u3092\u958B\u304F",nl_NL:"Document openen vanaf uw SharePoint Online-site",zh_CN:"\u4ECESharePoint\u8054\u673A\u7F51\u7AD9\u6253\u5F00\u6587\u6863"},SP_CREATE_DESCRIPTION_:{en_US:"Create a new document on your SharePoint Online site",de_DE:"Neues Dokument auf Ihrer SharePoint-Online-Seite erstellen",fr_FR:"Cr\xE9er un nouveau document dans votre site SharePoint Online",ja_JP:"SharePoint\u30AA\u30F3\u30E9\u30A4\u30F3\u30B5\u30A4\u30C8\u4E0A\u306B\u65B0\u3057\u3044\u30C9\u30AD\u30E5\u30E1\u30F3\u30C8\u3092\u4F5C\u6210\u3059\u308B",nl_NL:"Een nieuw document maken op uw SharePoint Online-site",zh_CN:"\u5728SharePoint Online\u7F51\u7AD9\u4E0A\u521B\u5EFA\u65B0\u6587\u6863"}};sync.Translation.addTranslations(N)})();(function(){var N=!1,D="sp-message",k="Author/Save",I="../plugins-dispatcher/sp-action";function u(){}goog.inherits(u,sync.actions.AbstractAction),u.ON_EDIT_START_KEY="sharepoint.onDocLoad",u.prototype.actionPerformed=function(t){var e=workspace.createDialog();e.setTitle(tr(msgs.SP_PREFS_)),e.setButtonConfiguration([{key:"apply",caption:tr(msgs.APPLY_)},{key:"cancel",caption:tr(msgs.CANCEL_)}]);var n={checkout:{value:"checkout"},noCheckout:{value:"nocheckout"},ask:{value:"ask"}},o;try{o=localStorage.getItem(u.ON_EDIT_START_KEY)}catch(s){console.warn(s)}switch(o){case"checkout":n.checkout.selected="selected";break;case"nocheckout":n.noCheckout.selected="selected";break;default:n.ask.selected="selected";break}var i=goog.dom.createDom,r=document.createDocumentFragment();r.appendChild(i("label","sp-prefs-dialog",tr(msgs.CHOOSE_EDIT_START_),i("select",{style:"width: 100%",name:u.ON_EDIT_START_KEY,class:"oxy-combo"},i("option",n.ask,tr(msgs.ALWAYS_ASK_)),i("option",n.checkout,tr(msgs.SHAREPOINT_CHECK_OUT_)),i("option",n.noCheckout,tr(msgs.DONT_CHECK_OUT_))))),e.getElement().appendChild(r),e.onSelect(function(s){if(s==="apply"){var a=e.getElement().querySelector('[name="'+u.ON_EDIT_START_KEY+'"]');try{localStorage.setItem(u.ON_EDIT_START_KEY,a.value)}catch(c){console.warn(c)}}e.dispose()}),e.show(),t()},u.prototype.getDisplayName=function(){return tr(msgs.SP_PREFS_)};function h(){this.options=null,this.editor=null,this.isCheckedOut=!1,this.isCheckedOutByCurrentUser=!1,goog.events.listen(workspace,sync.api.Workspace.EventType.BEFORE_EDITOR_LOADED,goog.bind(this.beforeEditorLoaded,this)),goog.events.listen(workspace,sync.api.Workspace.EventType.DASHBOARD_LOADED,function(t){N=!0;var e=window.location.hash;e&&(e.indexOf(f.ID)!==-1?y&&(location.hash="",y.actionPerformed()):e.indexOf(m.ID)!==-1&&T&&(location.hash="",T.actionPerformed()))})}h.prototype.beforeEditorLoaded=function(t){this.options=t.options,this.isCheckedOut=!1;var e=t.editor;this.editor=e;var n=t.options.url;if(this.isSharePointUrl(n)){if(t.options.autoSaveInterval=parseInt(sync.options.PluginsOptions.getClientOption("sp-autosave-interval")),window.location.href.indexOf("sharepoint-token-provided=true")!==-1){var o=window.opener||window.parent,i=goog.bind(this.receiveMessage,this);window.addEventListener("message",i,!1),goog.events.listenOnce(e,sync.api.Editor.EventTypes.DISPOSE,function(){window.removeEventListener("message",i,!1)}),o.postMessage({id:"token_request"},"*"),t.preventDefault()}else t.preventDefault(),_.authenticateUser(goog.bind(this.configureEditor,this));workspace.setUrlChooser(O),goog.events.listenOnce(e,sync.api.Editor.EventTypes.ACTIONS_LOADED,function(r){var s=new u,a="SP/Preferences";e.getActionsManager().registerAction(a,s);for(var c=r.actionsConfiguration.toolbars[0],C=c?c.children:[],p=0;p<C.length;p++){var v=C[p];if(v.name==="More..."){v.children.push({id:a,type:"action"});break}}})}},h.prototype.recommendCheckout=function(){if(R.isCheckedOut)this.setAutoSaving(!0);else{var t=goog.dom.createDom,e=t("input",{type:"checkbox",name:u.ON_EDIT_START_KEY,style:"height:initial;vertical-align:sub"}),n=t("label",{style:"z-index: 1;max-width: 47%;color: #909090;font-size:0.7em;height:20px;position:absolute;bottom:25px;left:20px"},e,tr(msgs.DONT_SHOW_AGAIN_)),o=trDom(msgs.DOCUMENT_NOT_CHECKED_OUT_,{$LINE_BREAK:t("br")});o.appendChild(n),R.showMessageDialog(tr(msgs.CHECK_OUT_RECOMMENDED_),o,[{key:"check.out",caption:tr(msgs.SHAREPOINT_CHECK_OUT_)},{key:"cancel",caption:tr(msgs.DONT_CHECK_OUT_)}],goog.bind(function(i,r){var s=e.checked;if(i==="check.out"){if(s)try{localStorage.setItem(u.ON_EDIT_START_KEY,"checkout")}catch(a){console.warn(a)}this.checkOutAction.actionPerformed(goog.bind(function(){this.setAutoSaving(!0)},this))}else{if(s)try{localStorage.setItem(u.ON_EDIT_START_KEY,"nocheckout")}catch(a){console.warn(a)}this.setAutoSaving(!0)}},this))}},h.prototype.setAutoSaving=function(t){var e=this.editor.getActionsManager().getActionById(k);!e||(t?typeof e.enableAutoSave=="function"&&e.enableAutoSave():typeof e.disableAutoSave=="function"&&e.disableAutoSave())},h.prototype.isSharePointUrl=function(t){return t.match(/^spo-https?:/)},h.prototype.receiveMessage=function(t){var e=sync.options.PluginsOptions.getClientOption("sp-message-origin");if(e!==t.origin){alert("SSO origin misconfigured in Web Author");return}if(typeof t.data=="object"&&typeof t.data.token=="string"&&!!t.data.token){var n=t.data.token,o=this;goog.net.XhrIo.send("../plugins-dispatcher/sp-oauth?token="+n,function(){goog.events.listen(o.editor,sync.api.Editor.EventTypes.LINK_OPENED,function(i){i.linkTarget=sync.api.Editor.LinkOpenedEvent.Target.SELF}),_.authenticateUser(goog.bind(o.configureEditor,o))},"POST","",{"X-Requested-With":"shp"})}},h.prototype.onEditorLoaded_=function(t){if(window.location.href.indexOf("preview=true")!==-1){console.log("Preview....");var e=["header","footer","left-panel"];e.forEach(function(r){var s=document.getElementById(r);s.style.display="none"});var n=[".ui-layout-resizer",".ui-layout-resizer-east.ui-layout-resizer",".ui-layout-toggler"];n.forEach(function(r){var s=document.querySelector(r);s&&(s.style.display="none")});var o=document.getElementById("editorContent");o.style.width="100%",o.style.height="100%",o.style.top="0",document.getElementById("editor-frame").style.overflow="hidden";var i=document.querySelector(".oxy-document");i.style.transform="scale(0.6, 0.6)",i.style.transformOrigin="0 0",i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.width="166%"}},h.prototype.configureEditor=function(){var t=_.sessionInfo;if(t){var e=t.user;e&&e.name&&(this.options.userName=e.name)}goog.events.listen(workspace,sync.api.Workspace.EventType.EDITOR_LOADED,this.onEditorLoaded_);var n;try{n=localStorage.getItem(u.ON_EDIT_START_KEY)}catch{console.warn()}var o=n==="ask"||!n;o?goog.events.listenOnce(this.editor,sync.api.Editor.EventTypes.DIRTY_STATUS_CHANGED,goog.bind(this.recommendCheckout,this)):goog.events.listenOnce(this.editor,sync.api.Editor.EventTypes.DIRTY_STATUS_CHANGED,goog.bind(function(){n==="checkout"&&!this.isCheckedOut&&this.checkOutAction.actionPerformed(goog.bind(function(){this.setAutoSaving(!0)},this))},this)),goog.events.listen(workspace,sync.api.Workspace.EventType.EDITOR_LOADED,goog.bind(function(){this.setAutoSaving(!1),this.checkIsCheckedOut(!0)},this));var i=this.editor;i.getLoadingIndicator().setVisible(!0),i.load(this.options),this.registerSharePointActions(i),goog.events.listen(i,sync.api.Editor.EventTypes.CUSTOM_MESSAGE_RECEIVED,goog.bind(this.handleCustomMessage,this))},h.prototype.registerSharePointActions=function(t){this.checkOutAction=new g(t,this),this.checkInAction=new d(t,this),this.discardCheckOutAction=new l(t,this);var e=t.getActionsManager();e.registerAction(g.ID,this.checkOutAction),e.registerAction(d.ID,this.checkInAction),e.registerAction(l.ID,this.discardCheckOutAction);var n=[g.ID,d.ID,l.ID];goog.events.listen(t,sync.api.Editor.EventTypes.ACTIONS_LOADED,function(o){var i=o.actionsConfiguration,r,s=null;if(i.toolbars)for(r=0;r<i.toolbars.length;r++){var a=i.toolbars[r];a.name==="Builtin"&&(s=a)}if(s){for(s.children.push({type:"sep"}),r=0;r<n.length;r++)s.children.push({id:n[r],type:"action"});setTimeout(function(){t.getActionsManager().refreshActionsStatus(g.ID,d.ID,l.ID)},0)}})},h.prototype.handleCustomMessage=function(t){var e=t.context,n=t.editor,o=_.sessionInfo;o&&o.name&&(t.options.userName=o.name),_.authenticateUser(function(){var i=sync.api.Editor.WebappMessageReceived.Context;if(e===i.LOAD)window.location.reload();else if(e===i.EDITING)n.getActionsManager().getActionById("Author/Refresh_references").actionPerformed();else if(e===i.SAVE)n.getActionsManager().getActionById(k).actionPerformed(function(){});else if(e===i.IMAGE)for(var r=document.querySelectorAll("img[data-src]"),s=0;s<r.length;s++)r[s].src=goog.dom.dataset.get(r[s],"src")})},h.prototype.setCheckedOut=function(t,e){this.isCheckedOut=t,this.isCheckedOutByCurrentUser=e,R.editor.actionsManager.refreshActionsStatus(g.ID,d.ID,l.ID);var n=document.querySelector(".decorators");if(t)goog.dom.removeChildren(n),n.appendChild(goog.dom.createDom("span",{id:"sp-check-out-deco"}));else{var o=n.querySelector("span#sp-check-out-deco");o&&n.removeChild(o)}},h.prototype.checkIsCheckedOut=function(t,e){var n={action:"is.checked.out",url:this.options.url},o=this;goog.net.XhrIo.send(I,function(i){var r=i.target,s=r.getResponseJson(),a=!1,c=!1,C;if(s&&(C=s["checked.out.by"],a=s["is.checked.out"],c=s["by.current.user"]),o.setCheckedOut(a,c),t&&a){var p;C?p=trDom(msgs.SP_DOCUMENT_CHECKED_OUT_BY_,{$USERNAME:goog.dom.createDom("span",{style:"font-size: 0.75em"},C)}):p=goog.dom.createTextNode(tr(msgs.SP_DOCUMENT_CHECKED_OUT_)),o.editor.problemReporter.showWarning(p,!0)}e&&e()},"POST",JSON.stringify(n),{"X-Requested-With":"shp"})},h.prototype.showMessageDialog=function(t,e,n,o){var i=workspace.createDialog();n=n||sync.api.Dialog.ButtonConfiguration.OK,i.setButtonConfiguration(n);var r=goog.dom.createDom;goog.dom.appendChild(i.getElement(),r("table","",r("col",{width:"16px"}),r("col",{width:"400px"}),r("tr","",r("td","",r("div","sp-message-err-icon")),r("td","",r("div",D),e)))),i.setTitle(t),typeof o=="function"?i.onSelect(function(s,a){o(s,a),i.dispose()}):i.onSelect(i.dispose.bind(i)),i.show()};var g=function(t,e){this.editor=t,this.editorHandler=e};g.ID="sp.checkout",goog.inherits(g,sync.actions.AbstractAction),g.prototype.getDisplayName=function(){return tr(msgs.SHAREPOINT_CHECK_OUT_)},g.prototype.actionPerformed=function(t){var e={action:"check.out",url:this.editor.options.url},n=this;goog.net.XhrIo.send(I,function(o){var i=o.target,r=i.getResponseJson();r.successful?(n.editorHandler.setCheckedOut(!0,!0),n.editor.problemReporter.showInfo(tr(msgs.SP_DOCUMENT_CHECKED_OUT_),!0)):r.error&&(n.editorHandler.showMessageDialog(tr(msgs.SP_CHECK_OUT_FAILED_),r.error),n.editorHandler.checkIsCheckedOut()),t&&t()},"POST",JSON.stringify(e),{"X-Requested-With":"shp"})},g.prototype.getLargeIcon=function(t){return sync.util.computeHdpiIcon("../plugin-resources/sharepoint/CheckOut24.png")},g.prototype.isEnabled=function(){return!this.editorHandler.isCheckedOut},g.prototype.getDescription=function(){return tr(msgs.SP_CHECK_OUT_DESCRIPTION_)};var d=function(t,e){this.editor=t,this.editorHandler=e};goog.inherits(d,sync.actions.AbstractAction),d.ID="sp.checkin",d.prototype.getDisplayName=function(){return tr(msgs.SHAREPOINT_CHECK_IN_)},d.prototype.actionPerformed=function(t){if(this.editor.isDirty()){var e=workspace.createDialog();e.setTitle(tr(msgs.SAVE_)),e.setButtonConfiguration(sync.api.Dialog.ButtonConfiguration.YES_NO),goog.dom.appendChild(e.getElement(),goog.dom.createDom("div",D,trDom(msgs.SP_DIRTY_CHECK_IN_WARNING_,{$LINE_BREAK:goog.dom.createDom("br")})));var n=this;e.onSelect(function(o){if(o==="yes"){var i=n.editor.getActionsManager().getActionById(k);i&&i.actionPerformed(goog.bind(n.checkIn,n,t))}else n.checkIn(t)}),e.show()}else this.checkIn(t)},d.prototype.checkIn=function(t){var e=workspace.createDialog();e.setTitle(tr(msgs.SHAREPOINT_CHECK_IN_)),e.setButtonConfiguration(sync.api.Dialog.ButtonConfiguration.OK_CANCEL);var n=goog.dom.createDom;goog.dom.appendChild(e.getElement(),n("div","sp-check-in",n("div","sp-check-in-type",n("span",D,tr(msgs.SP_CHECK_IN_WHICH_VERSION_)),n("div",["sp-radio","vertical-align-children"],n("label","",n("input",{type:"radio",name:"check-in-type",id:"check-in-minor"}),n("span","",tr(msgs.CHECK_IN_MINOR_VERSION_)))),n("div",["sp-radio","vertical-align-children"],n("label","",n("input",{type:"radio",name:"check-in-type",id:"check-in-major"}),n("span","",tr(msgs.CHECK_IN_MAJOR_VERSION_))))),n("div","check-in-comment",n("span",D,tr(msgs.SP_DESCRIBE_CHANGES_)),n("span","sp-textarea",n("textarea",{rows:5,cols:50,id:"check-in-comment"}))))),e.getElement().querySelector("#check-in-minor").checked=!0;var o=this;e.onSelect(function(i){if(i==="ok"){var r=e.getElement().querySelector("#check-in-comment"),s=r.value,a;e.getElement().querySelector("#check-in-major").checked?a=1:a=0;var c={action:"check.in",url:o.editor.options.url,comment:s,type:a};goog.net.XhrIo.send(I,function(C){var p=C.target,v=p.getResponseJson();v.successful?(o.editorHandler.setCheckedOut(!1,!1),o.editor.problemReporter.showInfo(tr(msgs.SP_DOCUMENT_CHECKED_IN_),!0)):v.error&&(o.editorHandler.showMessageDialog(tr(msgs.SP_CHECK_IN_FAILED_),v.error,[{key:"save.as",caption:tr(msgs.SAVE_AS_A_DIFFERENT_FILE_)},{key:"cancel",caption:tr(msgs.CANCEL_)}],function(L){if(L==="save.as"){var w=o.editor.getActionsManager().getActionById("Author/SaveAs");w?w.actionPerformed(function(){}):o.editor.problemReporter.showError(tr(msgs.SAVE_AS_A_DIFFERENT_FILE_)+" "+tr(msgs.FAILED_),!0)}}),o.editorHandler.checkIsCheckedOut()),t&&t()},"POST",JSON.stringify(c),{"X-Requested-With":"shp"})}else t&&t();e.dispose()}),e.show()},d.prototype.getLargeIcon=function(t){return sync.util.computeHdpiIcon("../plugin-resources/sharepoint/CheckIn24.png")},d.prototype.isEnabled=function(){return sync.options.PluginsOptions.getClientOption("sp-anyone-can-check-in")?this.editorHandler.isCheckedOut:this.editorHandler.isCheckedOut&&this.editorHandler.isCheckedOutByCurrentUser},d.prototype.getDescription=function(){return tr(msgs.SP_CHECK_IN_DOCUMENT_)};var l=function(t,e){this.editor=t,this.editorHandler=e};l.ID="sp.discard.checkout",goog.inherits(l,sync.actions.AbstractAction),l.prototype.getDisplayName=function(){return tr(msgs.DISCARD_CHECK_OUT_)},l.prototype.actionPerformed=function(t){var e=workspace.createDialog();e.setTitle(tr(msgs.DISCARD_CHECK_OUT_)),e.setButtonConfiguration(sync.api.Dialog.ButtonConfiguration.YES_NO),goog.dom.appendChild(e.getElement(),goog.dom.createDom("div",D,trDom(msgs.DISCARD_CHECK_OUT_WARNING_,{$LINE_BREAK:goog.dom.createDom("br")})));var n=this;e.onSelect(function(o){o==="yes"?n.discardCheckOut(t):t&&t()}),e.show()},l.prototype.discardCheckOut=function(t){var e={action:"discard.check.out",url:this.editor.options.url},n=this;goog.net.XhrIo.send(I,function(o){var i=o.target,r=i.getResponseJson();r.successful?(n.editorHandler.setCheckedOut(!1,!1),n.editor.problemReporter.showInfo(tr(msgs.SP_CHECK_OUT_DISCARDED_),!0),n.editor.setDirty(!1),window.location.reload()):r.error&&(n.editorHandler.showMessageDialog(tr(msgs.DISCARD_CHECK_OUT_)+" "+tr(msgs.FAILED_),r.error,[{key:"save.as",caption:tr(msgs.SAVE_AS_A_DIFFERENT_FILE_)},{key:"cancel",caption:tr(msgs.CANCEL_)}],function(s){if(s==="save.as"){var a=n.editor.getActionsManager().getActionById("Author/SaveAs");a?a.actionPerformed(function(){}):n.editor.problemReporter.showError(tr(msgs.SAVE_AS_A_DIFFERENT_FILE_)+" "+tr(msgs.FAILED_),!0)}}),n.editorHandler.checkIsCheckedOut()),t&&t()},"POST",JSON.stringify(e),{"X-Requested-With":"shp"})},l.prototype.getLargeIcon=function(t){return sync.util.computeHdpiIcon("../plugin-resources/sharepoint/DiscardCheckOut24.png")},l.prototype.isEnabled=function(){return this.editorHandler.isCheckedOut},l.prototype.getDescription=function(){return tr(msgs.SP_CHECK_IN_DISCARDING_CHANGES_)};function S(){this.sessionInfo=null}S.prototype.authenticateUser=function(t,e){if(this.sessionInfo&&this.sessionInfo.isConfigured&&this.sessionInfo.isAuth)t();else{var n=this,o=new goog.net.XhrIo;goog.events.listen(o,goog.net.EventType.COMPLETE,function(i){var r=this.getStatus();if(r===200){var s=this.getResponse();if(s){var a=JSON.parse(s);n.setSessionInfo(a),a&&(a.isConfigured?a.isAuth?t():n.showLoginDialog(e):n.showConfigDialog())}}else r>=100&&n.showLoginDialog()}),o.send("../plugins-dispatcher/sp-session","GET",null,{"Cache-Control":"no-cache, no-store, must-revalidate, private",Pragma:"no-cache",Expires:0},{"X-Requested-With":"shp"})}},S.prototype.logoutUser=function(t){if(this.sessionInfo&&this.sessionInfo.isConfigured&&this.sessionInfo.isAuth){var e=new goog.net.XhrIo;goog.events.listen(e,goog.net.EventType.COMPLETE,function(n){this.setSessionInfo(null),t()},!1,this),e.send("../plugins-dispatcher/sp-session","POST",null,{"Cache-Control":"no-cache, no-store, must-revalidate, private",Pragma:"no-cache",Expires:0,"X-Requested-With":"shp"})}},S.prototype.setSessionInfo=function(t){this.sessionInfo=t},S.prototype.showLoginDialog=function(t){var e=workspace.createDialog();e.setTitle(tr(msgs.SP_CONNECT_DIALOG_TITLE_)),e.setButtonConfiguration(sync.api.Dialog.ButtonConfiguration.CANCEL);var n=goog.dom.createDom,o=n("div",{id:"sp-login-button-container"});goog.dom.appendChild(e.getElement(),n("div","sp-login-dialog",o)),N||e.onSelect(function(a){var c=window.location;a==="cancel"&&(c.href=c.protocol+"//"+c.hostname+(c.port?":"+c.port:"")+c.pathname)});var i=window.location;t&&(i+="#"+encodeURIComponent(t));var r="&state="+encodeURIComponent(i),s="../plugins-dispatcher/sp-oauth?init=true"+r;goog.dom.append(o,tr(msgs.SP_CONNECT_INFO_),n("a",{id:"sp-oauth-button",title:tr(msgs.SP_CONNECT_BUTTON_TOOLTIP_),rel:"external",href:s},n("span","sp-icon-large"),n("span","sp-oauth-text",tr(msgs.SP_CONNECT_BUTTON_)))),e.show()},S.prototype.showConfigDialog=function(){var t=workspace.createDialog();t.setTitle(tr(msgs.SP_CONNECT_DIALOG_TITLE_)),t.setButtonConfiguration(sync.api.Dialog.ButtonConfiguration.CANCEL);var e=t.getElement();goog.dom.removeChildren(e),goog.dom.appendChild(e,goog.dom.createDom("div",["sp-login-dialog","sp-login-dialog-error"],trDom(msgs.SP_PLUGIN_BAD_CONFIG_,{$ANCHOR_START:{node:goog.dom.createDom("a",{target:"_blank",href:"admin.html#Plugins"}),end:"$ANCHOR_END"}}))),t.onSelect(function(n){if(n==="cancel"){var o=window.location.href,i=o.protocol+"//"+o.hostname+(o.port?":"+o.port:"")+o.pathname;o.href!==i&&(o.href=i)}}),t.show()};var E=function(){var t;if(!sync.util.getURLParameter("url")){var e;try{e=localStorage.getItem("sharepoint.latestUrl")}catch(n){console.warn(n)}t={initialUrl:e}}sync.api.FileBrowsingDialog.call(this,t)};goog.inherits(E,sync.api.FileBrowsingDialog),E.prototype.renderRepoPreview=function(t){!sync.util.getURLParameter("url")&&!this.renderedLogoutButton&&(this.renderTitleBarLogoutButton(t),this.renderedLogoutButton=!0);var e=this.getCurrentFolderUrl();if(e){t.title=tr(msgs.SERVER_URL_);var n=goog.dom.createDom,o=sync.util.getImageUrl("/images/SharePointWeb16.png",sync.util.getHdpiFactor()),i=n("button",{className:"sharepoint-domain-edit",title:tr(msgs.EDIT_SERVER_URL_)});goog.dom.removeChildren(t),goog.dom.appendChild(t,n("div","sharepoint-repo-preview",n("div",{className:"domain-icon",style:"background-image: url("+o+");"}),new sync.util.Url(e).getDomain(),i)),goog.events.listen(i,goog.events.EventType.CLICK,goog.bind(this.switchToRepoConfig,this,t))}},E.prototype.renderRepoEditing=function(t){var e=this;e.renderResourcesChooser(t);var n=[];_.sessionInfo&&_.sessionInfo.siteUrls&&(n=_.sessionInfo.siteUrls),e.resourcePicker.gotSuggestedSiteUrls(n),e.dialog.setPreferredSize(null,200)},E.prototype.renderResourcesChooser=function(t){goog.dom.removeChildren(t),goog.dom.appendChild(t,goog.dom.createDom("div",{className:"sp-resources-input-wrapper",autofocus:!0},goog.dom.createDom("input",{id:"sp-resources-input",class:"oxy-input",placeholder:tr(msgs.SP_SITE_TO_BROWSE_)})));var e=t.querySelector("#sp-resources-input");this.resourcePicker=new A(e)};function A(t){var e=goog.dom.createDom("div",{class:"sp-ac"});goog.dom.appendChild(document.body,e),this.renderer=new goog.ui.ac.Renderer(e),this.renderer.setAutoPosition(!0),this.renderer.setAnchorElement(t.parentNode),this.renderer.reposition(),this.inputhandler=new goog.ui.ac.InputHandler(null,null,!1,300),this.ac=new goog.ui.ac.AutoComplete(this,this.renderer,this.inputhandler),this.inputhandler.attachAutoComplete(this.ac),this.inputhandler.attachInputs(t),this.ac.setAutoHilite(!1),this.eventHandler=new goog.events.EventHandler(this),this.eventHandler.listen(t,goog.events.EventType.FOCUS,goog.bind(function(){this.ac.getSelectionHandler().update(!0)},this))}goog.inherits(A,goog.events.EventTarget),A.prototype.gotSuggestedSiteUrls=function(t){this.siteUrls=t,this.handler_&&(this.requestMatchingRows(this.token_,this.maxMatches_,this.handler_),this.handler_=null,this.maxMatches_=null,this.token_=null)},A.prototype.requestMatchingRows=function(t,e,n,o){this.handler_=n,this.token_=t,this.maxMatches_=e,this.siteUrls&&n(t,this.siteUrls)},E.prototype.handleOpenRepo=function(t,e){var n=document.getElementById("sp-resources-input").value;if(n){var o=this.processURL(n);try{localStorage.setItem("sharepoint.latestUrl",o)}catch(i){console.warn(i)}this.openUrl(o,!1,e)}},E.prototype.processURL=function(t){var e=t;return goog.string.startsWith(t,"spo-")||(e="spo-"+e),goog.string.endsWith(e,"/")||(e=e+"/"),e},E.prototype.renderTitleBarLogoutButton=function(t){var e=new goog.dom.DomHelper().getAncestorByClass(t,"modal-dialog"),n=this.sessionInfo&&this.sessionInfo.user.name||"",o=goog.dom.createDom("div","sp-logout-container",tr(msgs.DISCONNECT_)+" ",goog.dom.createDom("span","sp-username",n));e.appendChild(o),goog.events.listen(o,goog.events.EventType.CLICK,function(){_.logoutUser(function(){window.location.reload()})},!1,this)};var U=function(t){var e=t.getEventTarget();goog.events.listen(e,sync.api.FileBrowsingDialog.EventTypes.USER_ACTION_REQUIRED,goog.bind(_.showLoginDialog,_))},_=new S,R=new h,O=new E;U(O);var f=function(t){sync.actions.OpenAction.call(this,t);var e=sync.util.computeHdpiIcon("../plugin-resources/sharepoint/SharePoint70.png");this.setLargeIcon(e),this.setDescription(tr(msgs.SP_OPEN_DESCRIPTION_)),this.setActionId(f.ID),this.setActionName("SharePoint")};f.ID="sharepoint-open-action",goog.inherits(f,sync.actions.OpenAction),f.prototype.actionPerformed=function(){_.authenticateUser(goog.bind(f.superClass_.actionPerformed,this),f.ID)};var m=function(t){sync.api.CreateDocumentAction.call(this,t);var e=sync.util.computeHdpiIcon("../plugin-resources/sharepoint/SharePoint70.png");this.setLargeIcon(e),this.setDescription(tr(msgs.SP_CREATE_DESCRIPTION_)),this.setActionId(m.ID),this.setActionName("SharePoint")};m.ID="sharepoint-create-action",goog.inherits(m,sync.api.CreateDocumentAction),m.prototype.actionPerformed=function(){_.authenticateUser(goog.bind(m.superClass_.actionPerformed,this),m.ID)};var y=new f(O),T=new m(O),P=workspace.getActionsManager();P.registerOpenAction(y),P.registerCreateAction(T)})();})();
